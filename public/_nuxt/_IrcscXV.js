import{d as B,R as S,z as M,o as u,g as O,w as x,a as o,b as f,y as v,h as Q,s as b,l as k,ak as W,L as X,c,B as I,t as h,u as d,F as Y,r as Z,m as ee,ab as te,S as V,n as le,C as L,D as C,i as ae,f as se}from"./CYd5hogt.js";import{_ as re}from"./Dp_DNHpP.js";import oe from"./Cc-QcOWU.js";import{u as ne}from"./x9qqkFeM.js";const ie={class:"relative flex items-center justify-center"},ue=["src"],ce=B({__name:"PreviewModal",props:S({imageUrl:{default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const s=M(n,"modelValue");return(m,r)=>{const p=re,g=oe;return u(),O(g,{modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=y=>s.value=y)},{default:x(()=>[o("div",ie,[o("img",{class:"w-full",src:m.imageUrl,alt:"預覽圖"},null,8,ue),f(p,{class:"w-[3rem] absolute right-0 top-0 aspect-square rounded-full text-black",label:"關閉預覽圖",onClick:r[0]||(r[0]=v(y=>s.value=!1,["prevent"]))},{default:x(()=>r[2]||(r[2]=[Q(" × ")])),_:1})])]),_:1},8,["modelValue"])}}}),de={class:"w-full"},me={class:"mb-2"},pe={key:0,class:"flex items-center justify-start gap-x-1"},fe={key:0,class:"text-red-500 text-xs"},ge=["id"],ve={class:"text-gray-500"},ye={key:1,class:"grid grid-cols-3 w-full gap-2"},be={class:"border border-gray-300 left-[1.5rem] top-[1.5rem] w-[calc(100%_-_0.75rem)] text-white absolute aspect-square flex items-center justify-center gap-x-3 bg-black/50"},he=["id"],we={class:"text-gray-500"},Ie=B({__name:"MultipleUploader",props:S({label:{},id:{default:()=>V()},isShowLabel:{type:Boolean,default:!0},errorMessage:{default:""},placeholder:{default:""},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},acceptFileType:{default:"image"}},{modelValue:{default:null},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const s=M(n,"modelValue"),m=b([]),r=b(-1),p=b(!1),g=b(""),y=k(()=>{if(n.acceptFileType==="image")return"image/*";if(n.acceptFileType==="video")return"video/*"}),{open:U,onChange:A}=W({accept:y.value,multiple:!0}),{getLastFileFromFileList:T,isFileImage:_,isString:$,getFileArrayListFromFileList:P}=ne(),F=()=>{n.disabled||U()},D=e=>`background-image: url('${e}')`,j=async e=>{const t=new FileReader;return new Promise(l=>{t.onload=()=>{const a=t.result;if(!$(a)){l("");return}l(a)},t.readAsDataURL(e)})},q=async e=>{if(n.acceptFileType!=="image")return[];const t=P(e);return t===null||t.length===0?[]:t.every(a=>_(a))?Promise.all(t.map(a=>j(a))):[]},R=e=>{g.value=e,p.value=!0},E=()=>{g.value=""},N=e=>{if(n.acceptFileType!=="image")return null;const t=T(e);return t===null?null:_(t)?t:null},z=(e,t)=>{if(e===null)return null;const l=new DataTransfer,a=Array.from(e);return a.push(t),a.forEach(i=>{l.items.add(i)}),l.files},H=(e,t)=>{if(e===null||e.length===0)return null;const l=new DataTransfer,a=Array.from(e);return a.splice(t,1),a.forEach(i=>{l.items.add(i)}),l.files},G=e=>{const t=s.value,l=H(t,e);m.value.splice(e,1),s.value=l};A(async e=>{if(n.acceptFileType==="image"){const t=N(e);if(t===null)return;if(s.value===null){s.value=e;return}const l=z(s.value,t);s.value=l}});const J=k(()=>e=>({mouseover:()=>r.value=e,mouseleave:()=>r.value=-1}));return X(s,async e=>{const t=await q(e);m.value=t}),(e,t)=>{const l=se,a=ce;return u(),c("div",de,[o("div",me,[e.isShowLabel?(u(),c("span",pe,[e.required?(u(),c("span",fe," * ")):I("",!0),o("span",null,h(e.label),1)])):I("",!0)]),d(m).length===0?(u(),c("button",{key:0,id:e.id,type:"button",class:"border-dashed border-[1.5px] border-gray-300 flex flex-col aspect-[3/2] bg-gray-100 w-full cursor-pointer items-center justify-center gap-y-2 rounded-lg",onClick:v(F,["prevent"])},[f(l,{class:"font-bold",name:"i-heroicons-plus"}),o("span",ve,h(e.placeholder),1)],8,ge)):(u(),c("div",ye,[(u(!0),c(Y,null,Z(d(m),(i,w)=>(u(),c("div",ee({key:`${("useId"in e?e.useId:d(V))()}_${i}`,class:"border border-gray-300 p-[1.5rem] relative col-span-1 flex items-center justify-center rounded-xl"},te(d(J)(w))),[o("div",{class:"bg-contain bg-center bg-no-repeat aspect-square border border-gray-300 w-full bg-gray-100",style:le(D(i))},null,4),L(o("div",be,[f(l,{class:"cursor-pointer text-white text-3xl",name:"i-eva:eye-outline",role:"button",onClick:v(K=>R(i),["prevent"])},null,8,["onClick"]),f(l,{class:"cursor-pointer text-white text-2xl",name:"i-lucide:trash",role:"button",onClick:v(K=>G(w),["prevent"])},null,8,["onClick"])],512),[[C,d(r)===w]])],16))),128)),o("button",{id:e.id,type:"button",class:"border-dashed border-[1.5px] border-gray-300 flex flex-col bg-gray-100 col-span-1 aspect-square cursor-pointer items-center justify-center gap-y-2 rounded-lg",onClick:v(F,["prevent"])},[f(l,{class:"font-bold",name:"i-heroicons-plus"}),o("span",we,h(e.placeholder),1)],8,he)])),L(o("span",{class:"text-sm text-red-500"},h(e.errorMessage),513),[[C,e.errorMessage!==""]]),f(a,{modelValue:d(p),"onUpdate:modelValue":t[0]||(t[0]=i=>ae(p)?p.value=i:null),"image-url":d(g),onClose:E},null,8,["modelValue","image-url"])])}}});export{Ie as _,ce as a};
