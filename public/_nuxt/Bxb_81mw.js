import{_ as B}from"./DiniTw7G.js";import{u as L}from"./x9qqkFeM.js";import{d as N,H as j,o as g,c as v,F as K,r as R,a as m,A as V,s as U,x as q,p as A,J as M,b as r,w as _,t as T,al as O,u as o,y as w,h as x,q as F,am as z}from"./CYd5hogt.js";import{_ as E}from"./Dp_DNHpP.js";import{_ as H}from"./IhCzvswf.js";import{_ as J}from"./BlH-aw9X.js";import{u as G}from"./COQckHv3.js";import{u as Q,a as W,t as X}from"./BPqKb5GP.js";import{o as Y,s as Z}from"./BeNRzrwp.js";import{u as ee}from"./ipEDR5wJ.js";import"./CHoBo5sC.js";import"./BMigu0w3.js";const te=["for"],ne=["id","tabindex","disabled"],se=N({__name:"Verify",props:{codeNumber:{default:4},disabled:{type:Boolean,default:!1}},emits:["update:verifyCode"],setup(C,{emit:l}){const i=l,{isInputElement:u}=L(),d=[0,1,2,3,4,5,6,7,8,9],a=j("inputVerify"),c=e=>{if(e.key==="Backspace"||e.key==="Delete"||e.key==="Tab")return;const n=+e.key;(Number.isNaN(n)||!d.includes(n))&&e.preventDefault()},p=e=>{const n=a.value;if(n===null)return;if(e===n.length-1){n[e].blur();return}const t=n[e+1];t&&t.focus()},f=e=>{const n=e.target;if(!u(n))return;const t=n.value.split("").pop();t&&(n.value=t,p(n.tabIndex-1))},y=()=>{const e=a.value;return e===null?"":e.map(n=>n.value).join("")},b=()=>{i("update:verifyCode",y())};return(e,n)=>(g(),v("div",{class:V(["flex items-center justify-center gap-x-4 rounded-xl px-4 py-3",[e.disabled?"bg-gray-100":"bg-[#FFF6F3]"]])},[(g(!0),v(K,null,R(e.codeNumber,t=>(g(),v("label",{key:t,for:`code_number_${t}`},[m("input",{id:`code_number_${t}`,ref_for:!0,ref:"inputVerify",class:V(["w-6 bg-transparent px-2 py-1 outline-none",[e.disabled?"border-b-2 border-gray-300":"border-b-2 border-orange-500"]]),type:"text",tabindex:t,disabled:e.disabled,onKeydown:c,onKeyup:f,onChange:b},null,42,ne)],8,te))),128))],2))}}),oe=Y({verifyCode:Z().length(4,"請輸入4位驗證碼")}),re=(C,l)=>{const i=U(!1),u=X(oe),d={verifyCode:""},{handleSubmit:a,isSubmitting:c,resetForm:p,errors:f}=Q({validationSchema:u,initialValues:d}),y=a(q(async e=>{i.value=!0,!await C(e)&&l&&l(),i.value=!1},800)),{value:b}=W("verifyCode");return{verifyCode:b,formSubmit:y,isSubmitting:c,isSubmittingDisabled:i,resetForm:p,errors:f}},ae={class:"relative mb-8 w-full flex items-center justify-between h-[calc(100vh_-_3.25rem)] md:h-[calc(100vh_-_4.625rem)]"},ve=N({__name:"verifycode",setup(C){const l=G(),{handleForgetPasswordVerifyCode:i}=l,u=A(),{verifyCode:d,formSubmit:a,isSubmittingDisabled:c,errors:p}=re(async t=>{const s=await i(t.verifyCode);return F(u("newPassword")),s}),{reVerifyCodeCount:f,startCounter:y,getKeyTimeStamp:b,resetCounter:e}=ee(),n=t=>{d.value=t,d.value.length===4&&a()};return M(()=>{const t="verifyTime",s=b(t);y(s,t)}),(t,s)=>{const h=B,$=se,I=z,S=E,D=H,P=J;return g(),v("div",ae,[r(h,{class:"absolute left-0 top-0 h-[85%] hidden md:inline-block",src:"pet_images/login/pet-left.png"}),r(h,{class:"absolute right-0 top-0 h-[85%] hidden md:inline-block",src:"pet_images/login/pet-right.png"}),r(P,{class:"absolute left-1/2 flex flex-col transform items-center justify-center -translate-x-1/2 w-4/5 md:w-1/2 gap-y-4"},{default:_(()=>[r(h,{class:"w-1/4 md:w-1/5",src:"pet_images/login/plane.svg"}),s[5]||(s[5]=m("p",{class:"text-2xl"}," 驗證碼已發送！ ",-1)),m("p",null,"發送地址: "+T((t._.provides[O]||t.$route).query.email),1),m("form",{class:"w-9/10 md:w-2/3 flex flex-col items-center gap-y-4",onSubmit:s[1]||(s[1]=w((...k)=>o(a)&&o(a)(...k),["prevent"]))},[r($,{class:"w-full",disabled:o(f)===0||o(c),"onUpdate:verifyCode":n},null,8,["disabled"]),m("div",null,[r(I,null,{default:_(()=>[m("span",null," 沒收到驗證碼？（"+T(o(f))+"秒） ",1)]),_:1}),r(S,{label:"再次發送按鈕",class:"text-orange-600 underline",onClick:w(o(e),["prevent"])},{default:_(()=>s[2]||(s[2]=[x(" 再次發送 ")])),_:1},8,["onClick"])]),r(D,{type:"submit",class:"w-full text-white",label:"取得驗證碼按鈕",disabled:o(c)||typeof o(p).verifyCode<"u"},{default:_(()=>s[3]||(s[3]=[x(" 取得驗證碼 ")])),_:1},8,["disabled"]),r(S,{label:"試試其他信箱按鈕",class:"text-orange-600 underline",onClick:s[0]||(s[0]=w(k=>("navigateTo"in t?t.navigateTo:o(F))(o(u)("forgotPassword")),["prevent"]))},{default:_(()=>s[4]||(s[4]=[x(" 試試其他信箱 ")])),_:1})],32)]),_:1})])}}});export{ve as default};
