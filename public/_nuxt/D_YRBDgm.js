import{d as X,o as x,c as V,a as s,b as i,t as B,w as S,f as Y,T as we,l as Z,s as ee,x as le,z as Ve,G as W,L as Le,g as ae,y as M,u as t,i as q,r as D,C as he,D as Te,F as O,h as F,J as Me,B as ie,m as $e}from"./CYd5hogt.js";import{_ as ce}from"./BKjW2vGI.js";import{_ as Pe}from"./DiniTw7G.js";import{_ as ke}from"./ByO9Jult.js";import{_ as ue}from"./Dp_DNHpP.js";import{I as de,P as Q,p as Ce,a as H,S as Ne,b as oe,c as je}from"./BjsByrvX.js";import{_ as pe}from"./BBBjUXBf.js";import{_ as Ue}from"./B3dFsN5O.js";import{_ as me}from"./IhCzvswf.js";import{_ as Ie}from"./BVCmbStn.js";import{_ as qe}from"./BvyazkRx.js";import{_ as Ae}from"./CCxXcF8T.js";import{_ as Ee}from"./CPz06D4e.js";import ze from"./Cc-QcOWU.js";import{c as ne}from"./CF0ZCrHm.js";import{u as Be}from"./CFKnWy4K.js";import{u as De,o as R,n as E,a as K,l as z,s as re}from"./BeNRzrwp.js";import{u as fe,a as U,t as ve}from"./BPqKb5GP.js";import{u as Oe}from"./BH6_UoY5.js";import{u as Fe}from"./COQckHv3.js";import"./CHoBo5sC.js";import"./BAiSaNHi.js";import"./1m7GWKYw.js";import"./DtpQx0Ne.js";import"./DMkMXhoc.js";import"./D6nfLA0K.js";import"./B08LnwSc.js";import"./CxIZtCgj.js";import"./Ceo9jh4g.js";import"./csYfvOSo.js";import"./DCEB7hob.js";import"./B-DIYZFu.js";import"./DIRaKQ2Y.js";import"./CFvfiu6T.js";import"./CFNrXGhF.js";import"./CCp9-jSB.js";import"./DvBWbfjg.js";import"./C9qe5ka0.js";import"./Whr4gT_R.js";import"./JsBdDeMb.js";import"./DdymJfvm.js";import"./DXrSQcim.js";import"./BMigu0w3.js";const Qe={class:"flex items-center justify-between rounded-xl border border-gray-300 px-3 py-2"},Re={class:"flex items-center justify-center gap-x-4"},Ge={class:"flex flex-col items-start gap-y-2"},Je={class:"text-gray-400"},We={class:"flex items-center justify-center gap-x-4"},He=X({__name:"ServiceEditCard",props:{iconName:{default:()=>de.Sitter},name:{},description:{default:""}},setup(y){return(c,d)=>{const p=ke,m=Y,g=ue;return x(),V("div",Qe,[s("div",Re,[i(p,{active:"",class:"aspect-square h-full text-4xl","icon-name":c.iconName},null,8,["icon-name"]),s("div",Ge,[s("p",null,B(c.name),1),s("p",Je,B(c.description),1)])]),s("div",We,[i(g,{label:`刪除${c.name}服務項目按鈕`,class:"flex items-center justify-center gap-x-2 text-orange-600"},{default:S(()=>[d[0]||(d[0]=s("span",null,"刪除",-1)),i(m,{name:"i-heroicons:trash"})]),_:1},8,["label"]),i(g,{label:`編輯${c.name}服務項目按鈕`,class:"flex items-center justify-center gap-x-2 text-orange-600"},{default:S(()=>[d[1]||(d[1]=s("span",null,"編輯",-1)),i(m,{name:"i-pepicons-pop:pen"})]),_:1},8,["label"])])])}}}),Ke=()=>{const y=p=>new Promise(m=>setTimeout(m,p));return{getMainServiceList:async()=>(await y(500),[{id:1,name:"到府褓母",price:520,iconName:de.Sitter,description:"到府提供照護"}]),addPetSitterService:async p=>(console.log(p),await y(500),!0)}},Se=we("useMemberSettingStore",()=>({mainServiceList:[]}),y=>{const{customTypeError:c,fatalError:d}=De(),{getMainServiceList:p,addPetSitterService:m}=Ke(),g=async()=>{try{const u=await p();return L(u),!0}catch(u){return c(u)||d(u),!1}},L=u=>{y.mainServiceList=u},_=async u=>{try{return await m(u)}catch(w){return c(w)||d(w),!1}};return{mainServiceList:Z(()=>y.mainServiceList),handleGetMainServiceList:g,handleAddPetSitterService:_}}),Xe=R({id:E().int().nonnegative("請輸入正整數或0"),petType:K(Q).or(z(-1)),extraServiceList:Ce.array().optional(),petSize:K(H).optional()}),Ye=R({serviceType:K(Ne).or(z("")).optional(),serviceCityName:E().or(z("")).optional(),serviceRegionName:E().or(z("")).optional(),price:E().int().nonnegative("請輸入正整數或0"),petServiceSettingList:Xe.array()}),Ze=(y,c)=>{const d=ee(!1),p=ve(Ye),m={serviceType:"",serviceCityName:"",serviceRegionName:"",price:0,petServiceSettingList:[{id:1,petType:Q.Dog,extraServiceList:[],petSize:H.MEDIUM}]},{handleSubmit:g,isSubmitting:L,resetForm:_,errors:u}=fe({validationSchema:p,initialValues:m}),w=g(le(async f=>{d.value=!0,!await y(f)&&c&&c(),d.value=!1},800)),{value:$}=U("serviceType"),{value:P}=U("serviceCityName"),{value:b}=U("serviceRegionName"),{value:k}=U("price"),{value:h}=U("petServiceSettingList"),N=Z(()=>{const f=h.value.map(o=>o.petType).filter(o=>o!==-1);return Object.entries(oe).map(([o,r])=>+o).filter(o=>!f.includes(o))});return{serviceType:$,serviceCityName:P,serviceRegionName:b,price:k,petServiceSettingList:h,formSubmit:w,isSubmitting:L,isSubmittingDisabled:d,resetForm:_,errors:u,removeExtraServiceItem:(f,o)=>{const r=h.value.find(e=>e.id===f);if(!r||!r.extraServiceList)return;const l=r.extraServiceList.findIndex(e=>e.id===o);l!==-1&&r.extraServiceList.splice(l,1)},addExtraServiceItem:f=>{const o=h.value.find(e=>e.id===f);if(!o)return;const r={id:1,name:"",price:0};if(!o.extraServiceList){o.extraServiceList=[r];return}const l=Math.max(...o.extraServiceList.map(e=>e.id))+1;o.extraServiceList.push({id:l,name:"",price:0})},addMainServiceItem:()=>{const f=Math.max(...h.value.map(l=>l.id)),o=N.value;if(console.group("%c test","color: yellow;"),console.log(o),console.groupEnd(),o.length===0)return;const r={id:f+1,petType:o[0],extraServiceList:[]};o[0]===Q.Dog&&(r.petSize=H.MEDIUM),h.value.push(r)},getPetTypeOptionList:f=>{const o=h.value.map(r=>r.petType).filter(r=>r!==-1&&r!==f);return Object.entries(oe).map(([r,l])=>({value:+r,title:l})).filter(r=>!o.includes(r.value))}}},et={class:"flex items-center justify-between px-4 py-3 border-b-solid border-b-[1px] border-b-gray-300"},tt={class:"flex items-start gap-x-2"},st={class:"sticky bottom-0"},it={class:"flex items-center justify-end gap-x-4 bg-white px-4 py-3 border-t border-gray-300"},ot=X({__name:"AddService",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(y){const c=Ve(y,"modelValue"),d=Be(),{serviceTypeOptionList:p}=W(d),m=Se(),{handleAddPetSitterService:g}=m,{serviceType:L,serviceCityName:_,serviceRegionName:u,price:w,petServiceSettingList:$,formSubmit:P,isSubmittingDisabled:b,resetForm:k,errors:h,removeExtraServiceItem:N,addExtraServiceItem:n,addMainServiceItem:I,getPetTypeOptionList:j}=Ze(async l=>await g(l)),A=ne.map(l=>({value:l.city,title:l.city})),f=Z(()=>{const l=ne.find(e=>e.city===_.value);return l?l.districts.map(e=>({value:e.name,title:e.name})):[]}),o=Object.entries(je).map(([l,e])=>({value:+l,title:e})),r=()=>{c.value=!1,k()};return Le(c,l=>{l||k()}),(l,e)=>{const v=Ie,C=qe,te=pe,be=Ae,xe=Ee,G=Y,ye=ue,J=ce,ge=me,_e=ze;return x(),ae(_e,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=a=>c.value=a),fullscreen:"",ui:{container:"flex items-center justify-center w-full",fullscreen:"w-full h-full md:w-[40vw] md:max-h-[95vh]",base:"rounded-xl shadow-xl border-solid border-[1px] border-gray-200 overflow-y-auto py-[2.5] gap-y-4"}},{default:S(()=>[s("div",null,[s("div",et,[e[6]||(e[6]=s("h3",null,"新增服務",-1)),i(v,{onClick:M(r,["prevent"])})]),s("form",{class:"flex flex-col gap-y-4 px-4 py-3",onSubmit:e[4]||(e[4]=M((...a)=>t(P)&&t(P)(...a),["prevent"]))},[i(C,{id:"serviceType",modelValue:t(L),"onUpdate:modelValue":e[0]||(e[0]=a=>q(L)?L.value=a:null),label:"預約服務",required:"","is-full-size":"",options:t(p),disabled:t(b),"error-message":t(h).serviceType,"no-value":"",placeholder:"選擇服務",class:"w-full"},null,8,["modelValue","options","disabled","error-message"]),s("div",tt,[i(C,{modelValue:t(_),"onUpdate:modelValue":e[1]||(e[1]=a=>q(_)?_.value=a:null),"is-show-label":!1,placeholder:"選擇縣市",label:"縣市",required:"",class:"w-1/2","is-full-size":"",options:t(A),disabled:t(b),"no-value":""},null,8,["modelValue","options","disabled"]),i(C,{modelValue:t(u),"onUpdate:modelValue":e[2]||(e[2]=a=>q(u)?u.value=a:null),label:"行政區",placeholder:"選擇城鄉鎮市區","is-show-label":!1,"is-full-size":"",required:"",class:"w-1/2","no-value":"",options:t(f),disabled:t(b)},null,8,["modelValue","options","disabled"])]),i(te,{modelValue:t(w),"onUpdate:modelValue":e[3]||(e[3]=a=>q(w)?w.value=a:null),label:"金額","is-show-label":!1,placeholder:"金額",disabled:t(b),class:"w-full"},{default:S(()=>e[7]||(e[7]=[s("div",{class:"flex items-center justify-center bg-gray-200 border-r border-gray-300 px-2"}," NT$ ",-1)])),_:1},8,["modelValue","disabled"]),(x(!0),V(O,null,D(t($),a=>(x(),V("div",{key:a.id,class:"flex flex-col gap-y-4"},[i(C,{modelValue:a.petType,"onUpdate:modelValue":T=>a.petType=T,label:"寵物種類",required:"",options:t(j)(a.petType),disabled:t(b),"is-full-size":"",class:"w-full","no-value":-1,placeholder:"請選擇寵物種類"},null,8,["modelValue","onUpdate:modelValue","options","disabled"]),he(i(be,{modelValue:a.petSize,"onUpdate:modelValue":T=>a.petSize=T,label:"寵物尺寸","is-show-label":!1,placeholder:"請選擇寵物尺寸",required:"","is-full-size":"",class:"w-full",options:t(o),disabled:t(b)},null,8,["modelValue","onUpdate:modelValue","options","disabled"]),[[Te,a.petType===t(Q).Dog]]),e[10]||(e[10]=s("h4",null,"額外服務細項",-1)),(x(!0),V(O,null,D(a.extraServiceList??[],T=>(x(),V("div",{key:T.id,class:"flex items-center gap-x-4"},[i(xe,{id:`${a.id}_extra_${T.id}`,modelValue:T.name,"onUpdate:modelValue":se=>T.name=se,"is-show-label":!1,label:"細項名稱",placeholder:"請輸入細項名稱",disabled:t(b),required:"",class:"flex-grow"},null,8,["id","modelValue","onUpdate:modelValue","disabled"]),i(te,{label:"服務細項金額","is-show-label":!1,placeholder:"金額",disabled:t(b)},{default:S(()=>e[8]||(e[8]=[s("div",{class:"flex items-center justify-center bg-gray-200 border-r border-gray-300 px-2"}," NT$ ",-1)])),_:1},8,["disabled"]),i(ye,{label:`刪除${T.name}服務項目按鈕`,class:"flex items-center justify-center gap-x-2 text-orange-600",onClick:M(se=>t(N)(a.id,T.id),["prevent"])},{default:S(()=>[i(G,{name:"i-heroicons:trash"})]),_:2},1032,["label","onClick"])]))),128)),i(J,{label:"新增額外服務細項按鈕",class:"w-full flex items-center justify-center gap-x-2 rounded-xl text-orange-600",onClick:M(T=>t(n)(a.id),["prevent"])},{default:S(()=>[e[9]||(e[9]=s("span",null,"額外服務細項",-1)),i(G,{class:"text-orange-600",name:"i-heroicons-plus"})]),_:2},1032,["onClick"])]))),128)),s("div",st,[s("div",it,[i(J,{label:"重設個人資料欄位按鈕",class:"min-w-24 flex items-center justify-center rounded-xl text-orange-600 border-solid border-[1px] border-orange-600",onClick:M(r,["prevent"])},{default:S(()=>e[11]||(e[11]=[F(" 取消 ")])),_:1}),i(J,{label:"新增額外服務細項按鈕",class:"items-self-start flex items-center justify-center gap-x-2 rounded-xl text-orange-600",onClick:M(t(I),["prevent"])},{default:S(()=>[e[12]||(e[12]=s("span",null,"新增服務寵物種類",-1)),i(G,{class:"text-orange-600",name:"i-heroicons-plus"})]),_:1},8,["onClick"]),i(ge,{type:"submit",label:"註冊會員送出按鈕",class:"min-w-24 text-white"},{default:S(()=>e[13]||(e[13]=[F(" 新增 ")])),_:1})])])],32)])]),_:1},8,["modelValue"])}}}),nt=R({question:re().min(1,"請輸入問題"),answer:re().min(1,"請輸入答案")}),rt=R({questionList:nt.array()}),lt=(y,c)=>{const d=ee(!1),p=ve(rt),m={questionList:[]},{handleSubmit:g,isSubmitting:L,resetForm:_,errors:u}=fe({validationSchema:p,initialValues:m}),w=g(le(async b=>{d.value=!0,!await y(b)&&c&&c(),d.value=!1},800)),{value:$}=U("questionList");return{questionList:$,formSubmit:w,isSubmitting:L,isSubmittingDisabled:d,resetForm:_,errors:u,addNewQA:()=>{$.value.push({question:"",answer:""})}}},at={key:0,class:"flex flex-col w-full items-center gap-y-4"},ct={class:"w-full rounded-xl bg-white"},ut={class:"border-b border-gray-300 flex items-center justify-between px-6 py-4"},dt={class:"px-4 py-3"},pt={key:0,class:"w-full flex flex-col items-center justify-center gap-y-2"},mt={key:1,class:"flex flex-col items-center gap-y-4"},ft={class:"border-b border-gray-300 px-6 py-4 flex items-center gap-x-2"},vt={class:"flex flex-col items-center px-4 py-3"},St={key:0,class:"mb-4 text-sm text-red-500"},bt={class:"flex items-center justify-start gap-x-2 px-4 py-3"},ls=X({__name:"settings",setup(y){const c=Oe(),{handleUpdatePetSitterQA:d}=c,p=Fe(),{fakeToken:m}=W(p),g=Se(),{handleGetMainServiceList:L}=g,{mainServiceList:_}=W(g),u=ee(!1),{questionList:w,formSubmit:$,isSubmittingDisabled:P,resetForm:b,errors:k,addNewQA:h}=lt(async N=>await d(N));return Me(async()=>{await L()}),(N,n)=>{const I=Y,j=ce,A=Pe,f=He,o=pe,r=Ue,l=me,e=ot;return t(m)!==null?(x(),V("div",at,[s("section",ct,[s("div",ut,[n[4]||(n[4]=s("p",null,"選擇服務",-1)),i(j,{label:"新增服務按鈕",class:"flex items-center justify-center gap-x-2 rounded-xl text-orange-600",onClick:n[0]||(n[0]=M(v=>u.value=!0,["prevent"]))},{default:S(()=>[n[3]||(n[3]=s("span",null,"新增服務",-1)),i(I,{name:"i-heroicons-plus"})]),_:1})]),s("div",dt,[t(_).length===0?(x(),V("div",pt,[i(A,{src:"pet_images/status/no-service.svg"}),n[5]||(n[5]=s("span",{class:"text-[#FB976E]"},"尚未提供服務",-1))])):(x(),V("div",mt,[(x(!0),V(O,null,D(t(_),v=>(x(),ae(f,$e({key:v.id,class:"w-full",ref_for:!0},v),null,16))),128))]))])]),s("form",{class:"w-full rounded-xl bg-white",onSubmit:n[1]||(n[1]=M((...v)=>t($)&&t($)(...v),["prevent"]))},[s("div",ft,[s("span",null,"關於 "+B(t(m).userName),1),n[6]||(n[6]=s("span",{class:"text-sm text-gray-300"},"可填寫飼主的常見問題",-1))]),s("div",vt,[(x(!0),V(O,null,D(t(w),v=>(x(),V("div",{key:v.question,class:"flex flex-col mb-4 w-full gap-y-4"},[i(o,{modelValue:v.question,"onUpdate:modelValue":C=>v.question=C,label:"輸入題目","is-show-label":!1,placeholder:"輸入題目",disabled:t(P),class:"w-full flex-grow"},{default:S(()=>n[7]||(n[7]=[s("div",{class:"flex items-center justify-center bg-gray-200 border-r border-gray-300 px-4"}," Q: ",-1)])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]),i(r,{modelValue:v.answer,"onUpdate:modelValue":C=>v.answer=C,"is-show-label":!1,label:"輸入解答",placeholder:"輸入解答",class:"w-full",disabled:t(P)},null,8,["modelValue","onUpdate:modelValue","disabled"])]))),128)),t(k).questionList?(x(),V("div",St,B(t(k).questionList),1)):ie("",!0),i(j,{label:"新增額外QA按鈕",class:"border border-orange-600 w-full flex items-center justify-center gap-x-2 rounded-xl text-orange-600",onClick:M(t(h),["prevent"])},{default:S(()=>[n[8]||(n[8]=s("span",null,"新增額外QA",-1)),i(I,{class:"text-xl",name:"i-heroicons-plus"})]),_:1},8,["onClick"])]),s("div",bt,[i(j,{label:"重設褓母QA欄位按鈕",class:"border border-orange-600 min-w-24 flex items-center justify-center rounded-xl text-orange-600",onClick:M(t(b),["prevent"])},{default:S(()=>n[9]||(n[9]=[F(" 重設 ")])),_:1},8,["onClick"]),i(l,{type:"submit",class:"min-w-24 text-white",label:"送出並儲存褓母QA按鈕"},{default:S(()=>n[10]||(n[10]=[F(" 儲存 ")])),_:1})])],32),i(e,{modelValue:t(u),"onUpdate:modelValue":n[2]||(n[2]=v=>q(u)?u.value=v:null)},null,8,["modelValue"])])):ie("",!0)}}});export{ls as default};
